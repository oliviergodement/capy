
<div class="row">
  <div class="col-sm-5">
    <h1>Société '<%= @firm.name %>'</h1>
  </div>
  <div class="col-sm-7">
    <%=button_to "Editer les détails de la société", edit_firm_path(@firm), method: 'get', class: "btn btn-primary pull-right" %>
    <% if @firm.rounds.count > 1 %>
      <%= button_to "Voir l'opération en cours", rounds_path(@firm), method: 'get', class: "btn btn-success center-block"%>
    <% else %>
      <%= button_to "Démarrer une augmentation de capital", new_round_path(@firm), method: 'get', class: "btn btn-success center-block"%>
    <% end %>
  </div>
</div>
<hr>
<div class="row">
  <div class="col-sm-8">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Informations sur la société</h3>
      </div>
      <div class="panel-body">
        <div class="col-sm-6">
          <p>Adresse : <%=@firm.official_address%></p>
          <p>Numéro RCS : <%=@firm.rcs%> (greffe de <%=@firm.court_service%>)</p>
          <p>Banque : <%=@firm.bank_name%> (agence <%=@firm.bank_agency%>)</p>
          <p>Adresse de la banque : <%=@firm.bank_agency_address%></p>
          <p>Numéro de compte : <%=@bank_account%></p>
        </div>
        <div class="col-sm-6">
          <p>Capital social pré-augmentation de capital: <strong><%= number_with_delimiter(@firm.initial_capital.to_s, delimiter: " ", separator: ",", locale: :fr) %></strong> €</p>
          <p><strong><%=@firm.shares%></strong> actions en circulation</p>
          <p>Valeur nominale de <strong><%=@firm.nominal_value.to_s%> €</strong></p>
        </div>
      </div>
    </div>
  </div>
  <% if @firm.rounds.count > 1 %>
    <div class="col-sm-4">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Infos post-levée</h3>
        </div>
        <div class="panel-body">
          <p>Montant levé : <%= number_with_delimiter(@firm.rounds.last.amount_raised, delimiter: " ", separator: ",", locale: :fr) %> € (<%= @firm.rounds.last.ownership_offered%>% du capital ouvert)</p>
          <p>Nouveau prix de l'action : <%= number_with_delimiter(@firm.real_value, locale: :fr) %> €</p>
          <p>Prime d'émission <%= @firm.premium.round(2) %> €</p>
          <p>Valorisation pre-money : <%= number_with_delimiter(@firm.pre_valuation, delimiter: " ", separator: ",", locale: :fr) %> €</p>
          <p>Valorisation post-money : <%= number_with_delimiter(@firm.post_valuation, delimiter: " ", separator: ",", locale: :fr) %> €</p>
        </div>
      </div>
    </div>
  <% end %>
</div>

<div class="row"></div>
<h3>Liste des actionnaires</h3>
<table class="table table-hover">
  <th>Prénom</th>
  <th>Nom</th>
  <th>Nb d'actions détenues</th>
  <th>Nb d'actions détenues (rompus)</th>
  <% if @firm.rounds.count > 1 %>
    <th>Montant non-souscrit (rompus)</th>
    <th>Prime d'émission</th>
  <% end %>
  <th>Capital détenu</th>
  <% @shareholders.order("created_at asc").each do |shareholder| %>
    <tr>
      <td><%= shareholder.first_name %></td>
      <td><%= shareholder.last_name %></td>
      <td><%= shareholder.shares.round(2) %> actions</td>
      <td><%= shareholder.corrected_shares %> actions</td>
      <% if @firm.rounds.count > 1 && !shareholder.initial_investor %>
        <td><%= shareholder.non_subscribed_amount.round(2) %> €</td>
        <td><%= (shareholder.corrected_shares * @firm.premium).round(2) %> €</td>
      <% else %>
        <td>0</td>
        <td>0</td>
      <% end %>
      <td><%= ((shareholder.shares.to_f/@firm.shares.to_f)*100).round(2)%>% </td>

    </tr>
  <% end %>
</table>